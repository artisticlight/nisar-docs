# NISAR Docs Spanish Translation Guide

This guide explains how to manage the Spanish version of the NISAR Data User Guide.

## How the System Works

The English site lives on the `main` branch. The Spanish site lives on the `spanish` branch. Both branches have the same file and directory structure — the only difference is that the `.md` page content and `myst.yml` navigation titles are in Spanish on the `spanish` branch.

When you push changes to the `spanish` branch, a GitHub Actions workflow automatically builds both the English and Spanish sites and deploys them together. The English site is served at the root URL and the Spanish site is served under `/es/`.

You work exclusively on the `spanish` branch. You do not need to make changes to `main`.

## Initial Setup

### Clone the repository and switch to the Spanish branch

```bash
git clone git@github.com:ua-asf/nisar-docs.git
cd nisar-docs
git checkout spanish
```

### Set up the local development environment

```bash
mamba env create -f environment.yml
mamba activate nisar-docs
```

### Preview the site locally

```bash
myst start
```

This launches a local server where you can see your changes as you make them. The local preview shows only the Spanish site.

## Translating Pages

### What to translate

1. **Page content** — the `.md` files in each directory. Translate the text content while preserving all MyST markup syntax (directives, cross-references, figures, etc.)
2. **Navigation titles** — in `myst.yml`, translate the `title:` values and any `short_title:` values in front matter of `.md` files
3. **Abbreviation expansions** — in `myst.yml` under `project.abbreviations`, translate the expansion text (the part after the colon)
4. **Logo text** — in `myst.yml`, change `logo_text` from "NISAR Data User Guide" to "Guía de Datos de Usuario NISAR"

### What NOT to translate

- **File names and directory names** — these must stay identical to the English branch so the language switcher works correctly
- **`nisar-docs.bib`** — bibliography entries reference published English-language documents
- **Images in `assets/`** — these are shared between both sites
- **`environment.yml`** — build dependencies
- **GitHub workflow files** in `.github/workflows/`
- **MyST directive syntax** — preserve all `:::`, `{figure}`, `{term}`, `{button}`, `@citation_key`, `(target-name)=`, and similar markup exactly as-is
- **HDF5 data paths** — paths like `/science/LSAR/GCOV/grids/frequency[A|B]/HHHH` are technical identifiers, not translatable text
- **Acronyms** — the short forms (GCOV, RSLC, etc.) stay the same; only their expansions in `myst.yml` abbreviations are translated

### Example: Translating a page

**English version** (`data-products/products-overview.md` on `main`):
```markdown
---
short_title: Data Products
---

(data-products-overview)=
# Data Products Overview

There are a range of data products generated by the NISAR mission team...
```

**Spanish version** (`data-products/products-overview.md` on `spanish`):
```markdown
---
short_title: Productos de Datos
---

(data-products-overview)=
# Descripción General de los Productos de Datos

Hay una variedad de productos de datos generados por el equipo de la misión NISAR...
```

Notice:
- The `short_title` is translated
- The target label `(data-products-overview)=` stays the same (it's an internal reference ID)
- The heading and body text are translated
- MyST syntax is preserved

### Preserving cross-references

Cross-references use target labels like `(data-products-overview)=` and link syntax like `[text](#data-products-overview)`. The target labels (the part in parentheses) must stay the same on both branches. Translate only the visible link text:

```markdown
<!-- English -->
[Data Products Overview](#data-products-overview)

<!-- Spanish -->
[Descripción General de los Productos de Datos](#data-products-overview)
```

### Preserving glossary terms

Glossary terms are defined in `:::{glossary}` blocks. Translate the term name and its definition, but keep the directive syntax:

```markdown
:::{glossary}

Corrección Radiométrica del Terreno (RTC)
: El producto GCOV de covarianza geocodificada de NISAR...

:::
```

When referencing glossary terms in text with `{term}`, update the term name to match the Spanish glossary:

```markdown
<!-- English -->
{term}`Radiometric Terrain Correction (RTC)`

<!-- Spanish -->
{term}`Corrección Radiométrica del Terreno (RTC)`
```

### Preserving figures

Figure directives stay the same structurally. Translate only the caption text:

````markdown
```{figure} ../assets/nisar-product-table.png
:name: nisar-product-table
:alt: Figura de los productos de NISAR indicando tipos de datos de entrada y roles de procesamiento
:align: left

Niveles de Productos de Datos de NISAR
```
````

The `:name:` label stays the same. The `:alt:` text and caption are translated.

### Preserving citations

Citations like `@l2_gcov_product_specs2025` reference the shared `.bib` file and stay as-is. The surrounding sentence is translated:

```markdown
<!-- English -->
A complete description of NISAR GCOV products is available in @l2_gcov_product_specs2025.

<!-- Spanish -->
Una descripción completa de los productos GCOV de NISAR está disponible en @l2_gcov_product_specs2025.
```

## Keeping the Spanish Branch in Sync

When changes are made to the English site (new pages, updated content, structural changes), you need to pull those changes into the `spanish` branch.

### Check what changed on the English site

```bash
git checkout spanish
git fetch origin

# See the list of files changed on main since your branch diverged
git diff spanish..origin/main --name-only

# See the full diff for a specific file
git diff spanish..origin/main -- data-products/level-2/gcov.md
```

### Merge structural changes from main

When non-content changes happen on `main` (new workflow files, updated `environment.yml`, new images in `assets/`), merge them in:

```bash
git checkout spanish
git fetch origin
git merge origin/main --no-commit
```

This stages all changes from `main` without committing. You can then:

1. **Accept non-content changes as-is** — workflow files, `environment.yml`, new assets
2. **Resolve conflicts in `.md` files** — keep your Spanish translations, incorporate any new sections or structural changes from the English version, then translate the new content
3. **Resolve conflicts in `myst.yml`** — if new ToC entries were added, keep your translated titles and add the new entries with translated titles

After resolving everything:

```bash
git add .
git commit -m "Merge structural changes from main"
git push origin spanish
```

### When a new page is added on main

1. Merge from `main` to get the new file
2. The new `.md` file arrives in English — translate it
3. Add the translated title to `myst.yml` in the ToC if it's not already there from the merge
4. Commit and push

### When an existing English page is updated

1. Use `git diff` to see what changed in the English version
2. Make the corresponding changes in your Spanish translation
3. Commit and push

## Pushing Changes

```bash
git add <files>
git commit -m "Translate <page name> to Spanish"
git push origin spanish
```

The site will automatically rebuild and deploy within a few minutes.

## Troubleshooting

### Local build errors

If `myst start` shows errors, check that:
- All MyST directive syntax is correctly formatted (matching `:::` pairs, correct indentation)
- All cross-reference targets exist (no typos in `(target-name)=` labels)
- All citation keys match entries in `nisar-docs.bib`

### Merge conflicts

Conflicts will almost always be in `.md` files or `myst.yml`. When resolving:
- Keep your Spanish text
- Incorporate any new structural elements (new sections, new directives) from the English version
- Translate the new English content

### A page doesn't exist yet in Spanish

Until you translate a page, it will contain the English content from when the `spanish` branch was created (or from the last merge). This is fine — users will see the English content as a fallback until the translation is ready.
